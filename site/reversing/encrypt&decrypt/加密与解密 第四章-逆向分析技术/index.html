<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../../../img/favicon.ico">
  <title>åŠ å¯†ä¸è§£å¯† ç¬¬å››ç«  é€†å‘åˆ†ææŠ€æœ¯ - 0Xor' CTF WriteUp</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../../../css/highlight.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "\u52a0\u5bc6\u4e0e\u89e3\u5bc6 \u7b2c\u56db\u7ae0 \u9006\u5411\u5206\u6790\u6280\u672f";
    var mkdocs_page_input_path = "reversing\\encrypt&decrypt\\\u52a0\u5bc6\u4e0e\u89e3\u5bc6 \u7b2c\u56db\u7ae0-\u9006\u5411\u5206\u6790\u6280\u672f.md";
    var mkdocs_page_url = "/reversing/encrypt&decrypt/\u52a0\u5bc6\u4e0e\u89e3\u5bc6 \u7b2c\u56db\u7ae0-\u9006\u5411\u5206\u6790\u6280\u672f/";
  </script>
  
  <script src="../../../js/jquery-2.1.1.min.js"></script>
  <script src="../../../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../../../js/highlight.pack.js"></script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../../.." class="icon icon-home"> 0Xor' CTF WriteUp</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="../../..">Welcome to 0Xor' WriteUp</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Reversing</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../Moblie/">Moblie</a>
                </li>
                <li class="">
                    
    <a class="" href="../../reversing%20misc/">reversing misc</a>
                </li>
                <li class=" current">
                    
    <span class="caption-text">Encrypt&decrypt</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../%E5%8A%A0%E5%AF%86%E4%B8%8E%E8%A7%A3%E5%AF%86%20%E7%AC%AC%E4%B8%80%E7%AB%A0-%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/">åŠ å¯†ä¸è§£å¯† ç¬¬ä¸€ç«  åŸºç¡€çŸ¥è¯†</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../%E5%8A%A0%E5%AF%86%E4%B8%8E%E8%A7%A3%E5%AF%86%20%E7%AC%AC%E4%B8%89%E7%AB%A0-%E9%9D%99%E6%80%81%E8%B0%83%E8%AF%95%E6%8A%80%E6%9C%AF/">åŠ å¯†ä¸è§£å¯† ç¬¬ä¸‰ç«  é™æ€è°ƒè¯•æŠ€æœ¯</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../%E5%8A%A0%E5%AF%86%E4%B8%8E%E8%A7%A3%E5%AF%86%20%E7%AC%AC%E4%BA%8C%E7%AB%A0-%E5%8A%A8%E6%80%81%E8%B0%83%E8%AF%95%E6%8A%80%E6%9C%AF/">åŠ å¯†ä¸è§£å¯† ç¬¬äºŒç«  åŠ¨æ€è°ƒè¯•æŠ€æœ¯</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../%E5%8A%A0%E5%AF%86%E4%B8%8E%E8%A7%A3%E5%AF%86%20%E7%AC%AC%E5%8D%81%E7%AB%A0-PE%E6%96%87%E4%BB%B6%E6%A0%BC%E5%BC%8F/">åŠ å¯†ä¸è§£å¯† ç¬¬åç«  PEæ–‡ä»¶æ ¼å¼</a>
                </li>
                <li class="toctree-l3 current">
                    
    <a class="current" href="./">åŠ å¯†ä¸è§£å¯† ç¬¬å››ç«  é€†å‘åˆ†ææŠ€æœ¯</a>
    <ul class="subnav">
            
    <li class="toctree-l4"><a href="#4">ç¬¬4ç«  é€†å‘åˆ†ææŠ€æœ¯</a></li>
    
        <ul>
        
            <li><a class="toctree-l5" href="#41">4.1 å¯åŠ¨å‡½æ•°</a></li>
        
            <li><a class="toctree-l5" href="#42">4.2 å‡½æ•°</a></li>
        
            <li><a class="toctree-l5" href="#421">4.2.1 å‡½æ•°çš„è¯†åˆ«</a></li>
        
            <li><a class="toctree-l5" href="#422">4.2.2 å‡½æ•°çš„å‚æ•°</a></li>
        
            <li><a class="toctree-l5" href="#43">4.3 æ•°æ®ç»“æ„</a></li>
        
            <li><a class="toctree-l5" href="#44">4.4  è™šå‡½æ•°</a></li>
        
            <li><a class="toctree-l5" href="#45">4.5  æ§åˆ¶è¯­å¥</a></li>
        
        </ul>
    

    <li class="toctree-l4"><a href="#49-99">4.9  æŒ‡ä»¤ä¿®æ”¹æŠ€å·§ 99</a></li>
    

    </ul>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../%E7%9B%AE%E5%BD%95/">ç›®å½•</a>
                </li>
    </ul>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Wargame</span>
    <ul class="subnav">
                <li class="">
                    
    <span class="caption-text">Crypto</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/crypto/%5Bctf.nuptzj.cn%5D_PHP_decode/">[ctf.nuptzj.cn] PHP decode</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/crypto/%5Bctf.nuptzj.cn%5D_base64_N_times/">[ctf.nuptzj.cn] base64 N times</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/crypto/%5Bctf.nuptzj.cn%5D_base64_all/">[ctf.nuptzj.cn] base64 all</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/crypto/%5Bctf.nuptzj.cn%5D_easy/">[ctf.nuptzj.cn] easy</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/crypto/%5Bctf.nuptzj.cn%5D_keyboard/">[ctf.nuptzj.cn] keyboard</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/crypto/%5Bctf.nuptzj.cn%5D_md5/">[ctf.nuptzj.cn] md5</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/crypto/%5Bctf.nuptzj.cn%5D_mixed_base64/">[ctf.nuptzj.cn] mixed base64</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/crypto/%5Bctf.nuptzj.cn%5D_vigenere/">[ctf.nuptzj.cn] vigenere</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/crypto/%5Bctf.nuptzj.cn%5D_xor/">[ctf.nuptzj.cn] xor</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/crypto/crypto_summary/">Crypto summary</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <span class="caption-text">Misc</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/misc/%5Bctf.nuptzj.cn%5D_gif/">[ctf.nuptzj.cn] gif</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/misc/%5Bctf.nuptzj.cn%5D_qiubilong/">[ctf.nuptzj.cn] qiubilong</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/misc/%5Bctf.nuptzj.cn%5D_tuzhong/">[ctf.nuptzj.cn] tuzhong</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <span class="caption-text">Reversing</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/reversing/%5Bbugku.com%5D_ali/">[bugku.com] ali</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/reversing/%5Bctf.nuptzj.cn%5D_ReadAsm2/">[ctf.nuptzj.cn] ReadAsm2</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/reversing/%5Bctf.nuptzj.cn%5D_maze/">[ctf.nuptzj.cn] maze</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/reversing/%5Bctf.nuptzj.cn%5D_py/">[ctf.nuptzj.cn] py</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/reversing/%5Bctf.nuptzj.cn%5D_wxyvm/">[ctf.nuptzj.cn] wxyvm</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/reversing/%5Bctf.nuptzj.cn%5D_wxyvm2/">[ctf.nuptzj.cn] wxyvm2</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/reversing/%5Bwhaleedu.com%5D_dice/">[whaleedu.com] dice</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/reversing/%5Bwhaleedu.com%5D_pyc1/">[whaleedu.com] pyc1</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <span class="caption-text">Web</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/web/%5Bbugku.com%5D_upload_test/">[bugku.com] upload test</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/web/%5Bbugku.com%5D_web2/">[bugku.com] web2</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/web/%5Bctf.nuptzj.cn%5D_20_years/">[ctf.nuptzj.cn] 20 years</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/web/%5Bctf.nuptzj.cn%5D_aaencode/">[ctf.nuptzj.cn] aaencode</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/web/%5Bctf.nuptzj.cn%5D_bypass_again/">[ctf.nuptzj.cn] bypass again</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/web/%5Bctf.nuptzj.cn%5D_cookie/">[ctf.nuptzj.cn] cookie</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/web/%5Bctf.nuptzj.cn%5D_md5_collision/">[ctf.nuptzj.cn] md5 collision</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/web/%5Bctf.nuptzj.cn%5D_multi-byte_character/">[ctf.nuptzj.cn] multi byte character</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/web/%5Bctf.nuptzj.cn%5D_mysql/">[ctf.nuptzj.cn] mysql</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/web/%5Bctf.nuptzj.cn%5D_pass%20check/">[ctf.nuptzj.cn] pass check</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/web/%5Bctf.nuptzj.cn%5D_php_0x/">[ctf.nuptzj.cn] php 0x</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/web/%5Bctf.nuptzj.cn%5D_php_LFI/">[ctf.nuptzj.cn] php LFI</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/web/%5Bctf.nuptzj.cn%5D_php_decode/">[ctf.nuptzj.cn] php decode</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/web/%5Bctf.nuptzj.cn%5D_qiandao/">[ctf.nuptzj.cn] qiandao</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/web/%5Bctf.nuptzj.cn%5D_qiandao2/">[ctf.nuptzj.cn] qiandao2</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/web/%5Bctf.nuptzj.cn%5D_sql_injection_1/">[ctf.nuptzj.cn] sql injection 1</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/web/%5Bctf.nuptzj.cn%5D_sql_injection_2/">[ctf.nuptzj.cn] sql injection 2</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/web/%5Bctf.nuptzj.cn%5D_sql_injection_4/">[ctf.nuptzj.cn] sql injection 4</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/web/%5Bctf.nuptzj.cn%5D_upload_file/">[ctf.nuptzj.cn] upload file</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/web/%5Bctf.nuptzj.cn%5D_url_redirect/">[ctf.nuptzj.cn] url redirect</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/web/%5Bctf.nuptzj.cn%5D_var_override/">[ctf.nuptzj.cn] var override</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/web/%5Bctf.nuptzj.cn%5D_web3/">[ctf.nuptzj.cn] web3</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/web/%5Bctf.nuptzj.cn%5D_where_are_you_come_from/">[ctf.nuptzj.cn] where are you come from</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/web/%5Bctf.nuptzj.cn%5D_x00/">[ctf.nuptzj.cn] x00</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/web/%5Bctf.nuptzj.cn%5D_zonghe/">[ctf.nuptzj.cn] zonghe</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/web/%5Bctf.nuptzj.cn%5D_zonghe2/">[ctf.nuptzj.cn] zonghe2</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/web/%5Bshiyanbar.com%5D_add_something/">[shiyanbar.com] add something</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/web/%5Bshiyanbar.com%5D_be_serious/">[shiyanbar.com] be serious</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/web/%5Bshiyanbar.com%5D_forms/">[shiyanbar.com] forms</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/web/%5Bshiyanbar.com%5D_guaiwanmojiao/">[shiyanbar.com] guaiwanmojiao</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/web/%5Bshiyanbar.com%5D_houtaidenglu/">[shiyanbar.com] houtaidenglu</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/web/%5Bshiyanbar.com%5D_post_fast/">[shiyanbar.com] post fast</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/web/%5Bshiyanbar.com%5D_simple_sql_injection/">[shiyanbar.com] simple sql injection</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/web/%5Bshiyanbar.com%5D_simple_sql_injection_2/">[shiyanbar.com] simple sql injection 2</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/web/%5Bshiyanbar.com%5D_simple_sql_injection_3/">[shiyanbar.com] simple sql injection 3</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/web/web_summary/">Web summary</a>
                </li>
    </ul>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Web</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../../web/sqlmap_learning/">Sqlmap learning</a>
                </li>
    </ul>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../..">0Xor' CTF WriteUp</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../..">Docs</a> &raquo;</li>
    
      
        
          <li>Reversing &raquo;</li>
        
      
        
          <li>Encrypt&decrypt &raquo;</li>
        
      
    
    <li>åŠ å¯†ä¸è§£å¯† ç¬¬å››ç«  é€†å‘åˆ†ææŠ€æœ¯</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <p>åŠ å¯†ä¸è§£å¯† ç¬¬2ç¯‡ è°ƒè¯•ç¯‡</p>
<h2 id="4">ç¬¬4ç«  é€†å‘åˆ†ææŠ€æœ¯</h2>
<h3 id="41">4.1 å¯åŠ¨å‡½æ•°</h3>
<ul>
<li>c/c++è¿è¡Œæ—¶å¯åŠ¨å‡½æ•°ä½œç”¨</li>
<li>æ£€ç´¢æŒ‡å‘æ–°è¿›ç¨‹çš„å‘½ä»¤è¡ŒæŒ‡é’ˆ</li>
<li>æ£€ç´¢æŒ‡å‘æ–°è¿›ç¨‹çš„ç¯å¢ƒå˜é‡æŒ‡é’ˆ</li>
<li>å…¨å±€å˜é‡åˆå§‹åŒ–</li>
<li>å†…å­˜å †æ ˆåˆå§‹åŒ–</li>
</ul>
<pre><code class="asm">00401020 &gt;/$  55            push    ebp
00401021  |.  8BEC          mov     ebp, esp
00401023  |.  6A FF         push    -1
00401025  |.  68 A0504000   push    004050A0
0040102A  |.  68 7C1C4000   push    00401C7C                         ;  SE å¤„ç†ç¨‹åºå®‰è£…
0040102F  |.  64:A1 0000000&gt;mov     eax, dword ptr fs:[0]
00401035  |.  50            push    eax
00401036  |.  64:8925 00000&gt;mov     dword ptr fs:[0], esp
0040103D  |.  83EC 10       sub     esp, 10
00401040  |.  53            push    ebx
00401041  |.  56            push    esi
</code></pre>

<h3 id="42">4.2 å‡½æ•°</h3>
<h3 id="421">4.2.1 å‡½æ•°çš„è¯†åˆ«</h3>
<ul>
<li>CALL</li>
<li>RET</li>
</ul>
<h3 id="422">4.2.2 å‡½æ•°çš„å‚æ•°</h3>
<h4 id="_1">åˆ©ç”¨å †æ ˆä¼ é€’</h4>
<pre><code class="asm">00401000 &gt;/$  6A 04         push    4                                ; /Arg2 = 00000004
00401002  |.  6A 03         push    3                                ; |Arg1 = 00000003
00401004  |.  E8 16000000   call    0040101F                         ; \Add.0040101F
00401009  |.  8BD8          mov     ebx, eax
0040100B  |.  6A 00         push    0                                ; /ExitCode = 0
0040100D  \.  FF15 00204000 call    [&lt;&amp;KERNEL32.ExitProcess&gt;]        ; \ExitProcess


0040101F  /$  55            push    ebp                              ;  ä¿æŠ¤ç°åœºåŸå…ˆçš„EBPæŒ‡é’ˆ
00401020  |.  8BEC          mov     ebp, esp                         ;  è®¾ç½®æ–°çš„EBPæŒ‡é’ˆï¼ŒæŒ‡å‘æ ˆé¡¶
00401022  |.  83EC 04       sub     esp, 4                           ;  åˆ†é…å±€éƒ¨å˜é‡æ‰€æœ‰ç©ºé—´
00401025  |.  8B45 0C       mov     eax, [ebp+C]                     ;  è°ƒç”¨å‚æ•°2
00401028  |.  8B5D 08       mov     ebx, [ebp+8]                     ;  è°ƒç”¨å‚æ•°1
0040102B  |.  895D FC       mov     [ebp-4] , ebx                    ;  å‚æ•°1æ”¾å±€éƒ¨å˜é‡é‡Œ
0040102E  |.  0345 FC       add     eax,[ebp-4]                      ;  å‚æ•°2ä¸å±€éƒ¨å˜é‡ç›¸åŠ 
00401031  |.  83C4 04       add     esp, 4                           ;  é‡Šæ”¾å±€éƒ¨å˜é‡æ‰€æœ‰ç©ºé—´
00401034  |.  5D            pop     ebp                              ;  æ¢å¤ç°åœºçš„ebpæŒ‡é’ˆ
00401035  \.  C2 0800       retn    8
</code></pre>

<ul>
<li>enter/leave</li>
</ul>
<p><code>enter = push ebp/move ebp,esp/sub esp,xxx</code>
   <code>leave = add esp,xxx/pop esp</code></p>
<p><code>asm
  enter xxx,0   ;0è¡¨ç¤ºåˆ›å»ºxxxæ”¾å±€éƒ¨å˜é‡
  ...
  leave 
  ret 8</code></p>
<ul>
<li>vc6.0 ä½¿ç”¨<code>maximize speed</code></li>
</ul>
<p><code>asm
  push par2 ;å‚æ•°2
  push par1 ;å‚æ•°1
  call test2
  {
    move eax, dword ptr [esp+04] ;è°ƒç”¨å‚æ•°1
      move ecx, dword ptr [esp+08] ;è°ƒç”¨å‚æ•°2
      ...
      ret 8
  }</code></p>
<h5 id="_2">åˆ©ç”¨å¯„å­˜å™¨ä¼ é€’å˜é‡</h5>
<ul>
<li>è§„èŒƒï¼š__fastcall</li>
</ul>
<p>```c
  /<strong><em>*</em></strong><strong><em>*</em></strong><strong><em>*</em></strong><strong><em>*</em></strong><strong><em>*</em></strong><strong><em>*</em></strong><strong><em>*</em></strong><strong><em>*</em><em>
  *  fastcallè°ƒç”¨                                                                                                   </em>
  *   (c)  çœ‹é›ªè½¯ä»¶å®‰å…¨ç½‘ç«™ www.pediy.com 2000-2008                         *
  </strong><strong><em>*</em></strong><strong><em>*</em></strong><strong><em>*</em></strong><strong><em>*</em></strong><strong><em>*</em></strong><strong><em>*</em></strong><strong><em>*</em></strong><strong>*</strong>/</p>
<p>int  __fastcall Add(char,long,int,int);</p>
<p>main(void)
   {
        Add(1,2,3,4);
        return 0;
   }</p>
<p>int __fastcall Add(char a, long b, int c, int d)</p>
<p>{
       return (a + b + c + d);
  }</p>
<p>```</p>
<p>vcç¼–è¯‘ï¼š <code>optimizations:default</code></p>
<h5 id="_3">åç§°ä¿®é¥°çº¦å®š</h5>
<ul>
<li>name mangling/name decoration</li>
<li>åŒä¸€åå­—å…·æœ‰ä¸åŒçš„å‚æ•°æˆ–è€…ä¸åŒçš„ä½œç”¨åŸŸ</li>
<li>cç¼–è¯‘æ—¶å‡½æ•°åä¿®é¥°çº¦å®šè§„åˆ™ï¼š</li>
<li>__stdcallè°ƒç”¨çº¦å®šï¼š_{functionname}@{byte_number}</li>
<li>_cdelè°ƒç”¨çº¦å®šï¼š_{functionname}</li>
<li>__fastcallè°ƒç”¨çº¦å®šï¼š@{functionname}@{byte_number}</li>
</ul>
<h4 id="423">4.2.3 å‡½æ•°çš„è¿”å›å€¼</h4>
<h5 id="0x1-return">0x1 ç”¨returnè¿”å›</h5>
<h5 id="0x2">0x2 é€šè¿‡å‚æ•°æŒ‰å¼•ç”¨æ–¹å¼è¿”å›</h5>
<h3 id="43">4.3 æ•°æ®ç»“æ„</h3>
<h4 id="431">4.3.1 å±€éƒ¨å˜é‡</h4>
<ol>
<li>
<p>åˆ©ç”¨å †æ ˆ</p>
</li>
<li>
<p><code>sub esp,8</code></p>
</li>
<li>
<p>è°ƒç”¨æ ¼å¼ï¼š</p>
<ul>
<li>å±€éƒ¨ï¼š[ebp-xxxx]</li>
<li>å‚æ•°è°ƒç”¨ï¼š[ebp+xxxx]</li>
</ul>
</li>
<li>
<p>å±€éƒ¨å˜é‡ä¸æ¸…é™¤å †æ ˆçš„å‡ ç§å½¢å¼</p>
<table>
<thead>
<tr>
<th>å½¢å¼ä¸€</th>
<th>å½¢å¼äºŒ</th>
<th>å½¢å¼ä¸‰</th>
</tr>
</thead>
<tbody>
<tr>
<td>sub esp,n<br /><br />add esp,n</td>
<td>add esp,-n<br />sub esp,-n</td>
<td>push reg<br />pop reg</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>å±€éƒ¨å˜é‡åˆå§‹åŒ–</p>
<ul>
<li>mov [ebp-04],5</li>
<li>push 5</li>
</ul>
</li>
<li>
<p>åˆ©ç”¨å¯„å­˜å™¨</p>
</li>
</ol>
<p>é™¤äº†å †æ ˆå ç”¨2ä¸ªå¯„å­˜å™¨å¤–ï¼Œç¼–è¯‘å™¨ä¼šåˆ©ç”¨å‰©ä¸‹çš„6ä¸ªé€šç”¨å¯„å­˜å™¨</p>
<h4 id="432">4.3.2 å…¨å±€å˜é‡</h4>
<ul>
<li>
<p>ä½äº.dataæ®µä¸­</p>
</li>
<li>
<p>æ ¼å¼ï¼š</p>
</li>
</ul>
<p><code>asm
  move eax,dword ptr [4084c0h]</code></p>
<ul>
<li>
<p>ä½œç”¨ï¼š</p>
</li>
<li>
<p>ä¼ é€’å‚æ•°</p>
</li>
<li>
<p>ä¼ é€’å‡½æ•°è¿”å›å€¼</p>
</li>
<li>
<p>ç¤ºä¾‹</p>
</li>
</ul>
<p>```c
  /<strong><em>*</em></strong><strong><em>*</em></strong><strong><em>*</em></strong><strong><em>*</em></strong><strong><em>*</em></strong><strong><em>*</em></strong><strong><em>*</em></strong><strong><em>*</em>*
  ã€ŠåŠ å¯†ä¸è§£å¯†ã€‹ç¬¬ä¸‰ç‰ˆé…å¥—å®ä¾‹
                                        4.3.2  å…¨å±€å˜é‡
  (c)  çœ‹é›ªè½¯ä»¶å®‰å…¨ç½‘ç«™ www.pediy.com 2000-2008
  </strong><strong><em>*</em></strong><strong><em>*</em></strong><strong><em>*</em></strong><strong><em>*</em></strong><strong><em>*</em></strong><strong><em>*</em></strong><strong><em>*</em></strong><strong>*</strong>/
  int z;</p>
<p>int add(int x,int y);
  int main(void)
   {
     int a=5,b=6;
     z=7;
     add(a,b);
     return 0;
   }</p>
<p>int add(int x,int y)
   {
     return(x+y+z);
   }
  ```</p>
<p>vc++6.0ç¼–è¯‘ï¼Œé€‰æ‹©ä¸ä¼˜åŒ–</p>
<ul>
<li>ä¸é™æ€å˜é‡ç±»ä¼¼ï¼Œä½†é™æ€å˜é‡åªåœ¨å®šä¹‰è¿™äº›å˜é‡çš„å‡½æ•°å†…æœ‰æ•ˆ</li>
</ul>
<h4 id="433">4.3.3  æ•°ç»„</h4>
<ul>
<li>
<p>å®ç°æ–¹å¼ï¼šåŸºå€+å˜é‡</p>
</li>
<li>
<p>ç¤ºä¾‹ï¼š</p>
</li>
</ul>
<p>```c
  /<strong><em>*</em></strong><strong><em>*</em></strong><strong><em>*</em></strong><strong><em>*</em></strong><strong><em>*</em></strong><strong><em>*</em></strong><strong><em>*</em></strong><strong><em>*</em>*
  ã€ŠåŠ å¯†ä¸è§£å¯†ã€‹ç¬¬ä¸‰ç‰ˆé…å¥—å®ä¾‹
                                        4.3.3 æ•°ç»„
  (c)  çœ‹é›ªè½¯ä»¶å®‰å…¨ç½‘ç«™ www.pediy.com 2000-2008
  </strong><strong><em>*</em></strong><strong><em>*</em></strong><strong><em>*</em></strong><strong><em>*</em></strong><strong><em>*</em></strong><strong><em>*</em></strong><strong><em>*</em></strong><strong>*</strong>/</p>
<p>#include <stdio.h></p>
<p>int main(void)
  {
    static int a[3]={0x11,0x22,0x33};
      int i,s=0,b[3];
    for(i=0;i&lt;3;i++)
    { 
        s=s+a[i];
        b[i]=s;
    }</p>
<pre><code>for(i=0;i&lt;3;i++)
{
    printf("%d\n",b[i]);
}

return 0;
</code></pre>
<p>}</p>
<p>```</p>
<p>ç¼–è¯‘ä¼˜åŒ–é€‰é¡¹ï¼šæœ€å¿«é€Ÿåº¦ï¼Œä½†æ˜¯æˆ‘buildå‡ºç°äº†é”™è¯¯ï¼š</p>
<blockquote>
<p>Command line error D2016 : '/O2' and '/GZ' command-line options are incompatible
æ‰§è¡Œ cl.exe æ—¶å‡ºé”™.</p>
</blockquote>
<ul>
<li>/GZÂ å¯ä»¥å¸®åŠ©æ•è·å†…å­˜é”™è¯¯ </li>
<li>/O1 æˆ– /O2 ä¼˜åŒ–å¼€å…³ï¼Œä½¿ç¨‹åºæœ€å°æˆ–æœ€å¿« </li>
</ul>
<p>æ—¢ç„¶ä¸¤ä¸ªé€‰é¡¹ä¸å…¼å®¹ï¼Œé‚£ä¹ˆå°±æŠŠ/GZå»æ‰ï¼Œç¼–è¯‘æˆåŠŸ :happy:</p>
<ul>
<li>sample</li>
</ul>
<p><code>asm
  mov eax,[407030h+eax]</code></p>
<ul>
<li>
<p>æ•°ç»„å­˜åœ¨ä½ç½®</p>
</li>
<li>
<p>å †æ ˆ</p>
</li>
<li>æ•°æ®æ®µ .data</li>
<li>
<p>åŠ¨æ€å†…å­˜</p>
</li>
<li>
<p>é—´æ¥å¯»å€ä¸€èˆ¬å‡ºç°åœ¨ï¼š</p>
</li>
<li>
<p>æ•°ç»„</p>
</li>
<li>
<p>ç»“æ„èµ‹å€¼</p>
</li>
<li>
<p>[åŸºå€+å¯„å­˜å™¨]</p>
</li>
<li>
<p>åŸºå€å¯ä»¥ä¸ºå¸¸é‡æˆ–è€…æ˜¯å¯„å­˜å™¨</p>
</li>
</ul>
<h3 id="44">4.4  è™šå‡½æ•°</h3>
<ul>
<li>
<p>è™šå‡½æ•°çš„åœ°å€ï¼šåœ¨è°ƒç”¨ä¹‹å‰åŠ ä»¥ç¡®å®š</p>
</li>
<li>
<p>è™šå‡½æ•°è¡¨ï¼ˆVirtual Tableï¼ŒVTBLï¼‰ï¼šå­˜æ”¾è™šå‡½æ•°çš„å¼•ç”¨</p>
</li>
<li>
<p>è™šå‡½æ•°è¡¨æŒ‡é’ˆï¼ˆVirtual Table Pointer,VPTRï¼‰:æŒ‡å‘å¯¹è±¡ä¸­çš„å‡½æ•°</p>
</li>
<li>
<p>ç¤ºä¾‹ï¼š</p>
</li>
</ul>
<p>```c
  /<strong><em>*</em></strong><strong><em>*</em></strong><strong><em>*</em></strong><strong><em>*</em></strong><strong><em>*</em></strong><strong><em>*</em></strong><strong><em>*</em></strong><strong><em>*</em>*
  ã€ŠåŠ å¯†ä¸è§£å¯†ã€‹ç¬¬ä¸‰ç‰ˆé…å¥—å®ä¾‹
                                      4.4 è™šå‡½æ•°
  (c)  çœ‹é›ªè½¯ä»¶å®‰å…¨ç½‘ç«™ www.pediy.com 2000-2008
  </strong><strong><em>*</em></strong><strong><em>*</em></strong><strong><em>*</em></strong><strong><em>*</em></strong><strong><em>*</em></strong><strong><em>*</em></strong><strong><em>*</em></strong><strong>*</strong>/</p>
<p>#include <stdio.h>
  class CSum
  {
  public:
    virtual int Add(int a, int b) 
    {
        return (a + b);
    }</p>
<pre><code>virtual int Sub(int a, int b )
{
    return (a - b);
}
</code></pre>
<p>};</p>
<p>void main()
  { <br />
    CSum*   pCSum = new CSum ;  </p>
<pre><code>pCSum-&gt;Add(1,2);
pCSum-&gt;Sub(1,2);
</code></pre>
<p>} </p>
<p>```</p>
<p>æ±‡ç¼–ä»£ç ï¼š</p>
<p><code>asm
  00401030 &gt; &gt; \56            push esi
  00401031   .  6A 04         push 0x4
  00401033   .  E8 88000000   call Calling_.operator new
  00401038   .  83C4 04       add esp,0x4
  0040103B   .  85C0          test eax,eax
  0040103D   .  74 0A         je XCalling_.00401049
  0040103F   .  C700 1C204100 mov dword ptr ds:[eax],offset Calling_.C&gt;
  00401045   .  8BF0          mov esi,eax
  00401047   .  EB 02         jmp XCalling_.0040104B
  00401049   &gt;  33F6          xor esi,esi
  0040104B   &gt;  8B06          mov eax,dword ptr ds:[esi]
  0040104D   .  6A 02         push 0x2
  0040104F   .  6A 01         push 0x1
  00401051   .  8BCE          mov ecx,esi
  00401053   .  FF10          call dword ptr ds:[eax]
  00401055   .  8B16          mov edx,dword ptr ds:[esi]
  00401057   .  6A 02         push 0x2
  00401059   .  6A 01         push 0x1
  0040105B   .  8BCE          mov ecx,esi
  0040105D   .  FF52 04       call dword ptr ds:[edx+0x4]
  00401060   .  5E            pop esi
  00401061   .  C3            retn</code></p>
<p><code>mov ecx,esi</code>ä¸­ï¼Œecxä¿å­˜äº† ==thisæŒ‡é’ˆ==ï¼Œä½†æ˜¯ä»æ±‡ç¼–ä»£ç ä¸Šçœ‹ï¼Œæ²¡çœ‹å‡ºthisæŒ‡é’ˆçš„ä½œç”¨</p>
<p>vtblä¸­çš„æ•°æ®ï¼š</p>
<p><code>0041201C &gt;05 10 40 00 0F 10 40 00  @.@.</code></p>
<p>addå‡½æ•°ï¼š</p>
<p><code>asm
  00401080 &gt; &gt; \8B4424 08     mov eax,dword ptr ss:[esp+0x8]
  00401084   .  8B4C24 04     mov ecx,dword ptr ss:[esp+0x4]
  00401088   .  03C1          add eax,ecx
  0040108A   .  C2 0800       retn 0x8</code></p>
<p>subå‡½æ•°ï¼š</p>
<p><code>asm
  004010A0 &gt; &gt; \8B4424 04     mov eax,dword ptr ss:[esp+0x4]
  004010A4   .  8B4C24 08     mov ecx,dword ptr ss:[esp+0x8]
  004010A8   .  2BC1          sub eax,ecx
  004010AA   .  C2 0800       retn 0x8</code></p>
<h3 id="45">4.5  æ§åˆ¶è¯­å¥</h3>
<h4 id="451-if-then-else">4.5.1  IF-THEN-ELSEè¯­å¥</h4>
<ul>
<li>
<p>æ±‡ç¼–ä»£ç </p>
</li>
<li>
<p>æ•´æ•°</p>
<ul>
<li>cmp </li>
</ul>
<p><code>a-b</code>çš„ç»“æœï¼Œå½±å“ZF/è¿›ä½/ç¬¦å·ä½/æº¢å‡ºæ ‡å¿—</p>
<p><code>asm
  cmp a,b
  jzï¼ˆjnzï¼‰ xxxx</code></p>
<ul>
<li>test</li>
</ul>
<p><code>a &amp;&amp;b</code> aå’Œbé€»è¾‘ä¸çš„ç»“æœï¼Œç»“æœä¸º0ï¼ŒZFç½®1</p>
<ul>
<li>or</li>
</ul>
</li>
</ul>
<pre><code class="asm">00401010   push        ecx
11:        int a,b=5;
12:   scanf(&quot;%d&quot;,&amp;a);
00401011   lea         eax,[esp]
00401015   push        eax
00401016   push        offset string &quot;%d&quot; (00416a30)
0040101B   call        scanf (00401050)
13:        if(a==0)
00401020   mov         eax,dword ptr [esp+8]
00401024   add         esp,8
00401027   test        eax,eax
00401029   jne         main+20h (00401030)
14:            a=8;
0040102B   mov         eax,8
15:
16:
17:        return a+b;
00401030   add         eax,5
18:    }
00401033   pop         ecx
00401034   ret

</code></pre>

<h4 id="452-switch-case">4.5.2  SWITCH-CASEè¯­å¥</h4>
<ul>
<li>æ²¡æœ‰ä¼˜åŒ–çš„æƒ…å†µä¸‹ï¼Œç¼–è¯‘ï¼š</li>
</ul>
<pre><code class="asm">00401010   push        ebp
00401011   mov         ebp,esp
00401013   sub         esp,8
00401016   mov         dword ptr [ebp-8],0CCCCCCCCh
0040101D   mov         dword ptr [ebp-4],0CCCCCCCCh
11:        int a;
12:        scanf(&quot;%d&quot;,&amp;a);
00401024   lea         eax,[a]
00401027   push        eax
00401028   push        offset ___xt_z+104h (00417a30)
0040102D   call        scanf (00401140)
00401032   add         esp,8
13:
14:        switch(a)
15:        {
00401035   mov         ecx,dword ptr [a]
00401038   mov         dword ptr [ebp-8],ecx
0040103B   cmp         dword ptr [ebp-8],1  ;case 1
0040103F   je          main+3Fh (0040104f)  
00401041   cmp         dword ptr [ebp-8],2  ;case 2
00401045   je          main+4Eh (0040105e)
00401047   cmp         dword ptr [ebp-8],0Ah    ;case 10
0040104B   je          main+5Dh (0040106d)
0040104D   jmp         main+6Ch (0040107c)
16:           case 1 :printf(&quot;a=1&quot;);
0040104F   push        offset ___xt_z+108h (00417a34)
00401054   call        printf (004010c0)
00401059   add         esp,4
17:                       break;
0040105C   jmp         main+79h (00401089)
18:           case 2 :printf(&quot;a=2&quot;);
0040105E   push        offset ___xt_z+10Ch (00417a38)
00401063   call        printf (004010c0)
00401068   add         esp,4
19:                       break;
0040106B   jmp         main+79h (00401089)
20:           case 10:printf(&quot;a=10&quot;);
0040106D   push        offset ___xt_z+110h (00417a3c)
00401072   call        printf (004010c0)
00401077   add         esp,4
21:                       break;
0040107A   jmp         main+79h (00401089)
22:           default :printf(&quot;a=default&quot;);
0040107C   push        offset ___xt_z+118h (00417a44)
00401081   call        printf (004010c0)
00401086   add         esp,4
23:                        break;
24:        }
25:
26:        return 0;
00401089   xor         eax,eax
</code></pre>

<ul>
<li>è®¾ç½®äº†æœ€å¤§é€Ÿåº¦çš„æƒ…å†µä¸‹ï¼Œç¼–è¯‘ï¼š</li>
</ul>
<pre><code class="asm">9:    int main(void)
10:    {
0040F9A0   push        ecx  ;ä¸ºå±€éƒ¨å˜é‡åˆ†é…å†…å­˜ï¼Œç›¸å½“äºsub esp,4
11:        int a;
12:        scanf(&quot;%d&quot;,&amp;a);
0040F9A1   lea         eax,[esp]
0040F9A5   push        eax
0040F9A6   push        offset string &quot;%d&quot; (00417d1c)
0040F9AB   call        scanf (00401140)
13:
14:        switch(a)
15:        {
0040F9B0   mov         eax,dword ptr [esp+8]
0040F9B4   add         esp,8
0040F9B7   dec         eax  ;æ£€æŸ¥eaxæ˜¯å¦ä¸º1ï¼Œå¦‚æœæ˜¯ï¼Œä¸‹ä¸€å¥å°±è·³è½¬
0040F9B8   je          main+55h (0040f9f5)  ;ç›¸å½“äºcase 1
0040F9BA   dec         eax  ;eaxå†å‡1ï¼Œå³åŸæ¥çš„eaxæ˜¯2
0040F9BB   je          main+44h (0040f9e4)  ;ç›¸å½“äº case 2
0040F9BD   sub         eax,8                ;åŸæ¥çš„å€¼ä¸º10
0040F9C0   je          main+33h (0040f9d3)  ;case 10
21:                       break;
22:           default :printf(&quot;a=default&quot;);
0040F9C2   push        offset string &quot;a=default&quot; (0041a358)
0040F9C7   call        printf (004010c0)
0040F9CC   add         esp,4
23:                        break;
24:        }
25:
26:        return 0;
0040F9CF   xor         eax,eax
27:    }
0040F9D1   pop         ecx
0040F9D2   ret
19:                       break;
20:           case 10:printf(&quot;a=10&quot;);
0040F9D3   push        offset string &quot;a=10&quot; (00417e94)
0040F9D8   call        printf (004010c0)
0040F9DD   add         esp,4
23:                        break;
24:        }
25:
26:        return 0;
0040F9E0   xor         eax,eax
27:    }
0040F9E2   pop         ecx
0040F9E3   ret
17:                       break;
18:           case 2 :printf(&quot;a=2&quot;);
0040F9E4   push        offset string &quot;a=2&quot; (00417a64)
0040F9E9   call        printf (004010c0)
0040F9EE   add         esp,4
23:                        break;
24:        }
25:
26:        return 0;
0040F9F1   xor         eax,eax
27:    }
0040F9F3   pop         ecx
0040F9F4   ret
16:           case 1 :printf(&quot;a=1&quot;);
0040F9F5   push        offset string &quot;a=1&quot; (00417a50)
0040F9FA   call        printf (004010c0)
0040F9FF   add         esp,4
23:                        break;
24:        }
25:
26:        return 0;
0040FA02   xor         eax,eax
27:    }
0040FA04   pop         ecx
0040FA05   ret

</code></pre>

<ul>
<li>å½“caseå–å€¼è¡¨ç¤ºä¸€ä¸ªç®—æœ¯çº§æ•°ï¼Œç¼–è¯‘å™¨ä¼šåˆ©ç”¨ä¸€ä¸ªè·³è½¬è¡¨æ¥å®ç°</li>
</ul>
<p>æ³¨ï¼šä½¿ç”¨vc6.0è°ƒè¯•ï¼Œäº§ç”Ÿçš„è°ƒè¯•ä¿¡æ¯ï¼Œä½†æ˜¯æœ‰ä¸€å¤„æ³¨é‡Šæœ‰æ˜æ˜¾çš„é—®é¢˜ï¼Œ<code>case 1</code>ä¸‹é¢æ˜¯æ²¡æœ‰defualtè¯­å¥çš„ï¼Œä½†æ˜¯vcçš„æ³¨é‡Šå´æ˜¾ç¤ºäº†<code>default :printf("a=default");</code>ï¼Œè¿™é‡Œéœ€è¦æ³¨æ„</p>
<pre><code class="asm">   int main(void)
11:    {
00401010 51                   push        ecx
12:        int a;
13:        scanf(&quot;%d&quot;,&amp;a);
00401011 8D 44 24 00          lea         eax,[esp]
00401015 50                   push        eax
00401016 68 58 7A 41 00       push        offset string &quot;%d&quot; (00417a58)
0040101B E8 80 01 00 00       call        scanf (004011a0)
14:
15:        switch(a)
16:        {
00401020 8B 4C 24 08          mov         ecx,dword ptr [esp+8]
00401024 83 C4 08             add         esp,8
00401027 8D 41 FF             lea         eax,[ecx-1]
0040102A 83 F8 06             cmp         eax,6 ;åˆ¤æ–­æ˜¯å¦ä¸ºdefaultèŠ‚ç‚¹
0040102D 77 7E                ja          $L545+11h (004010ad)
0040102F FF 24 85 C0 10 40 00 jmp         dword ptr [eax*4+4010C0h] ;è·³è½¬è¡¨
17:           case 1 :printf(&quot;a=1&quot;);
00401036 68 54 7A 41 00       push        offset string &quot;a=1&quot; (00417a54)
30:                       break;
31:
32:           default :printf(&quot;a=default&quot;);
0040103B E8 E0 00 00 00       call        printf (00401120)
00401040 83 C4 04             add         esp,4
33:                        break;
34:        }
35:
36:        return 0;
00401043 33 C0                xor         eax,eax
37:    }
00401045 59                   pop         ecx
00401046 C3                   ret
18:                       break;
19:           case 2 :printf(&quot;a=2&quot;);
00401047 68 50 7A 41 00       push        offset string &quot;a=2&quot; (00417a50)
30:                       break;
31:
32:           default :printf(&quot;a=default&quot;);
0040104C E8 CF 00 00 00       call        printf (00401120)
00401051 83 C4 04             add         esp,4
33:                        break;
34:        }
35:
36:        return 0;
00401054 33 C0                xor         eax,eax
37:    }
00401056 59                   pop         ecx
00401057 C3                   ret
20:                       break;
...//çœç•¥æ‰ç±»ä¼¼çš„å†…å®¹
31:
32:           default :printf(&quot;a=default&quot;);
004010AD 68 30 7A 41 00       push        offset string &quot;a=default&quot; (00417a30)
004010B2 E8 69 00 00 00       call        printf (00401120)
004010B7 83 C4 04             add         esp,4
33:                        break;
34:        }
35:
36:        return 0;
004010BA 33 C0                xor         eax,eax
37:    }
004010BC 59                   pop         ecx
004010BD C3                   ret
004010BE 8B FF                mov         edi,edi
004010C0 36 10 40 00          adc         byte ptr ss:[eax],al
004010C4 47                   inc         edi
004010C5 10 40 00             adc         byte ptr [eax],al
004010C8 58                   pop         eax
004010C9 10 40 00             adc         byte ptr [eax],al
004010CC 69 10 40 00 7A 10    imul        edx,dword ptr [eax],107A0040h
004010D2 40                   inc         eax
004010D3 00 8B 10 40 00 9C    add         byte ptr [ebx-63FFBFF0h],cl
004010D9 10 40 00             adc         byte ptr [eax],al
</code></pre>

<h4 id="453">4.5.3  è½¬ç§»æŒ‡ä»¤æœºå™¨ç çš„è®¡ç®—</h4>
<p><img alt="1533135272251" src="../../../_images/crypto/1533135272251.png" /></p>
<h4 id="454-setcc-91">4.5.4  æ¡ä»¶è®¾ç½®æŒ‡ä»¤ï¼ˆSETccï¼‰ 91</h4>
<h4 id="455-92">4.5.5  çº¯ç®—æ³•å®ç°é€»è¾‘åˆ¤æ–­ 92</h4>
<h4 id="46-93">4.6  å¾ªç¯è¯­å¥ 93</h4>
<h4 id="47-94">4.7  æ•°å­¦è¿ç®—ç¬¦ 94</h4>
<h5 id="471-94">4.7.1  æ•´æ•°çš„åŠ æ³•å’Œå‡æ³• 94</h5>
<h5 id="472-94">4.7.2  æ•´æ•°çš„ä¹˜æ³• 94</h5>
<h5 id="473-95">4.7.3  æ•´æ•°çš„é™¤æ³• 95</h5>
<h4 id="48-97">4.8  æ–‡æœ¬å­—ç¬¦ä¸² 97</h4>
<h5 id="481-97">4.8.1  å­—ç¬¦ä¸²å­˜å‚¨æ ¼å¼ 97</h5>
<h5 id="482-98">4.8.2  å­—ç¬¦å¯»å€æŒ‡ä»¤ 98</h5>
<h5 id="483-98">4.8.3  å­—æ¯å¤§å°å†™è½¬æ¢ 98</h5>
<h5 id="484-99">4.8.4  è®¡ç®—å­—ç¬¦ä¸²çš„é•¿åº¦ 99</h5>
<h1 id="49-99">4.9  æŒ‡ä»¤ä¿®æ”¹æŠ€å·§ 99</h1>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../%E7%9B%AE%E5%BD%95/" class="btn btn-neutral float-right" title="ç›®å½•">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../%E5%8A%A0%E5%AF%86%E4%B8%8E%E8%A7%A3%E5%AF%86%20%E7%AC%AC%E5%8D%81%E7%AB%A0-PE%E6%96%87%E4%BB%B6%E6%A0%BC%E5%BC%8F/" class="btn btn-neutral" title="åŠ å¯†ä¸è§£å¯† ç¬¬åç«  PEæ–‡ä»¶æ ¼å¼"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
      <p>0Xor</p>
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../%E5%8A%A0%E5%AF%86%E4%B8%8E%E8%A7%A3%E5%AF%86%20%E7%AC%AC%E5%8D%81%E7%AB%A0-PE%E6%96%87%E4%BB%B6%E6%A0%BC%E5%BC%8F/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../%E7%9B%AE%E5%BD%95/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../../..';</script>
    <script src="../../../js/theme.js"></script>
      <script src="../../../search/require.js"></script>
      <script src="../../../search/search.js"></script>

</body>
</html>
