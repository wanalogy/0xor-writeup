<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../../../img/favicon.ico">
  <title>加密与解密 第三章 静态调试技术 - 0Xor' CTF WriteUp</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../../../css/highlight.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "\u52a0\u5bc6\u4e0e\u89e3\u5bc6 \u7b2c\u4e09\u7ae0 \u9759\u6001\u8c03\u8bd5\u6280\u672f";
    var mkdocs_page_input_path = "reversing\\encrypt&decrypt\\\u52a0\u5bc6\u4e0e\u89e3\u5bc6 \u7b2c\u4e09\u7ae0-\u9759\u6001\u8c03\u8bd5\u6280\u672f.md";
    var mkdocs_page_url = "/reversing/encrypt&decrypt/\u52a0\u5bc6\u4e0e\u89e3\u5bc6 \u7b2c\u4e09\u7ae0-\u9759\u6001\u8c03\u8bd5\u6280\u672f/";
  </script>
  
  <script src="../../../js/jquery-2.1.1.min.js"></script>
  <script src="../../../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../../../js/highlight.pack.js"></script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../../.." class="icon icon-home"> 0Xor' CTF WriteUp</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="../../..">Welcome to 0Xor' WriteUp</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Reversing</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../Moblie/">Moblie</a>
                </li>
                <li class="">
                    
    <a class="" href="../../reversing%20misc/">reversing misc</a>
                </li>
                <li class=" current">
                    
    <span class="caption-text">Encrypt&decrypt</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../%E5%8A%A0%E5%AF%86%E4%B8%8E%E8%A7%A3%E5%AF%86%20%E7%AC%AC%E4%B8%80%E7%AB%A0-%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/">加密与解密 第一章 基础知识</a>
                </li>
                <li class="toctree-l3 current">
                    
    <a class="current" href="./">加密与解密 第三章 静态调试技术</a>
    <ul class="subnav">
            
    <li class="toctree-l4"><a href="#_1">第三章 静态分析技术</a></li>
    
        <ul>
        
            <li><a class="toctree-l5" href="#31">3.1 文件类型分析</a></li>
        
            <li><a class="toctree-l5" href="#32">3.2 静态反汇编</a></li>
        
            <li><a class="toctree-l5" href="#33">3.3 可执行文件的修改</a></li>
        
            <li><a class="toctree-l5" href="#34">3.4 静态分析技术应用实例</a></li>
        
            <li><a class="toctree-l5" href="#35">3.5 补充</a></li>
        
        </ul>
    

    </ul>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../%E5%8A%A0%E5%AF%86%E4%B8%8E%E8%A7%A3%E5%AF%86%20%E7%AC%AC%E4%BA%8C%E7%AB%A0-%E5%8A%A8%E6%80%81%E8%B0%83%E8%AF%95%E6%8A%80%E6%9C%AF/">加密与解密 第二章 动态调试技术</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../%E5%8A%A0%E5%AF%86%E4%B8%8E%E8%A7%A3%E5%AF%86%20%E7%AC%AC%E5%8D%81%E7%AB%A0-PE%E6%96%87%E4%BB%B6%E6%A0%BC%E5%BC%8F/">加密与解密 第十章 PE文件格式</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../%E5%8A%A0%E5%AF%86%E4%B8%8E%E8%A7%A3%E5%AF%86%20%E7%AC%AC%E5%9B%9B%E7%AB%A0-%E9%80%86%E5%90%91%E5%88%86%E6%9E%90%E6%8A%80%E6%9C%AF/">加密与解密 第四章 逆向分析技术</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../%E7%9B%AE%E5%BD%95/">目录</a>
                </li>
    </ul>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Wargame</span>
    <ul class="subnav">
                <li class="">
                    
    <span class="caption-text">Crypto</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/crypto/%5Bctf.nuptzj.cn%5D_PHP_decode/">[ctf.nuptzj.cn] PHP decode</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/crypto/%5Bctf.nuptzj.cn%5D_base64_N_times/">[ctf.nuptzj.cn] base64 N times</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/crypto/%5Bctf.nuptzj.cn%5D_base64_all/">[ctf.nuptzj.cn] base64 all</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/crypto/%5Bctf.nuptzj.cn%5D_easy/">[ctf.nuptzj.cn] easy</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/crypto/%5Bctf.nuptzj.cn%5D_keyboard/">[ctf.nuptzj.cn] keyboard</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/crypto/%5Bctf.nuptzj.cn%5D_md5/">[ctf.nuptzj.cn] md5</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/crypto/%5Bctf.nuptzj.cn%5D_mixed_base64/">[ctf.nuptzj.cn] mixed base64</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/crypto/%5Bctf.nuptzj.cn%5D_vigenere/">[ctf.nuptzj.cn] vigenere</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/crypto/%5Bctf.nuptzj.cn%5D_xor/">[ctf.nuptzj.cn] xor</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/crypto/crypto_summary/">Crypto summary</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <span class="caption-text">Misc</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/misc/%5Bctf.nuptzj.cn%5D_gif/">[ctf.nuptzj.cn] gif</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/misc/%5Bctf.nuptzj.cn%5D_qiubilong/">[ctf.nuptzj.cn] qiubilong</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/misc/%5Bctf.nuptzj.cn%5D_tuzhong/">[ctf.nuptzj.cn] tuzhong</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <span class="caption-text">Reversing</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/reversing/%5Bbugku.com%5D_ali/">[bugku.com] ali</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/reversing/%5Bctf.nuptzj.cn%5D_ReadAsm2/">[ctf.nuptzj.cn] ReadAsm2</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/reversing/%5Bctf.nuptzj.cn%5D_maze/">[ctf.nuptzj.cn] maze</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/reversing/%5Bctf.nuptzj.cn%5D_py/">[ctf.nuptzj.cn] py</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/reversing/%5Bctf.nuptzj.cn%5D_wxyvm/">[ctf.nuptzj.cn] wxyvm</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/reversing/%5Bctf.nuptzj.cn%5D_wxyvm2/">[ctf.nuptzj.cn] wxyvm2</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/reversing/%5Bwhaleedu.com%5D_dice/">[whaleedu.com] dice</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/reversing/%5Bwhaleedu.com%5D_pyc1/">[whaleedu.com] pyc1</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <span class="caption-text">Web</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/web/%5Bbugku.com%5D_upload_test/">[bugku.com] upload test</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/web/%5Bbugku.com%5D_web2/">[bugku.com] web2</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/web/%5Bctf.nuptzj.cn%5D_20_years/">[ctf.nuptzj.cn] 20 years</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/web/%5Bctf.nuptzj.cn%5D_aaencode/">[ctf.nuptzj.cn] aaencode</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/web/%5Bctf.nuptzj.cn%5D_bypass_again/">[ctf.nuptzj.cn] bypass again</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/web/%5Bctf.nuptzj.cn%5D_cookie/">[ctf.nuptzj.cn] cookie</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/web/%5Bctf.nuptzj.cn%5D_md5_collision/">[ctf.nuptzj.cn] md5 collision</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/web/%5Bctf.nuptzj.cn%5D_multi-byte_character/">[ctf.nuptzj.cn] multi byte character</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/web/%5Bctf.nuptzj.cn%5D_mysql/">[ctf.nuptzj.cn] mysql</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/web/%5Bctf.nuptzj.cn%5D_pass%20check/">[ctf.nuptzj.cn] pass check</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/web/%5Bctf.nuptzj.cn%5D_php_0x/">[ctf.nuptzj.cn] php 0x</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/web/%5Bctf.nuptzj.cn%5D_php_LFI/">[ctf.nuptzj.cn] php LFI</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/web/%5Bctf.nuptzj.cn%5D_php_decode/">[ctf.nuptzj.cn] php decode</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/web/%5Bctf.nuptzj.cn%5D_qiandao/">[ctf.nuptzj.cn] qiandao</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/web/%5Bctf.nuptzj.cn%5D_qiandao2/">[ctf.nuptzj.cn] qiandao2</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/web/%5Bctf.nuptzj.cn%5D_sql_injection_1/">[ctf.nuptzj.cn] sql injection 1</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/web/%5Bctf.nuptzj.cn%5D_sql_injection_2/">[ctf.nuptzj.cn] sql injection 2</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/web/%5Bctf.nuptzj.cn%5D_sql_injection_4/">[ctf.nuptzj.cn] sql injection 4</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/web/%5Bctf.nuptzj.cn%5D_upload_file/">[ctf.nuptzj.cn] upload file</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/web/%5Bctf.nuptzj.cn%5D_url_redirect/">[ctf.nuptzj.cn] url redirect</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/web/%5Bctf.nuptzj.cn%5D_var_override/">[ctf.nuptzj.cn] var override</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/web/%5Bctf.nuptzj.cn%5D_web3/">[ctf.nuptzj.cn] web3</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/web/%5Bctf.nuptzj.cn%5D_where_are_you_come_from/">[ctf.nuptzj.cn] where are you come from</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/web/%5Bctf.nuptzj.cn%5D_x00/">[ctf.nuptzj.cn] x00</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/web/%5Bctf.nuptzj.cn%5D_zonghe/">[ctf.nuptzj.cn] zonghe</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/web/%5Bctf.nuptzj.cn%5D_zonghe2/">[ctf.nuptzj.cn] zonghe2</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/web/%5Bshiyanbar.com%5D_add_something/">[shiyanbar.com] add something</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/web/%5Bshiyanbar.com%5D_be_serious/">[shiyanbar.com] be serious</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/web/%5Bshiyanbar.com%5D_forms/">[shiyanbar.com] forms</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/web/%5Bshiyanbar.com%5D_guaiwanmojiao/">[shiyanbar.com] guaiwanmojiao</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/web/%5Bshiyanbar.com%5D_houtaidenglu/">[shiyanbar.com] houtaidenglu</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/web/%5Bshiyanbar.com%5D_post_fast/">[shiyanbar.com] post fast</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/web/%5Bshiyanbar.com%5D_simple_sql_injection/">[shiyanbar.com] simple sql injection</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/web/%5Bshiyanbar.com%5D_simple_sql_injection_2/">[shiyanbar.com] simple sql injection 2</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/web/%5Bshiyanbar.com%5D_simple_sql_injection_3/">[shiyanbar.com] simple sql injection 3</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../wargame/web/web_summary/">Web summary</a>
                </li>
    </ul>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Web</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../../web/sqlmap_learning/">Sqlmap learning</a>
                </li>
    </ul>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../..">0Xor' CTF WriteUp</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../..">Docs</a> &raquo;</li>
    
      
        
          <li>Reversing &raquo;</li>
        
      
        
          <li>Encrypt&decrypt &raquo;</li>
        
      
    
    <li>加密与解密 第三章 静态调试技术</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <p>加密与解密 第2篇 调试篇</p>
<h2 id="_1">第三章 静态分析技术</h2>
<h3 id="31">3.1 文件类型分析</h3>
<h4 id="311-peid">3.1.1 PEiD工具</h4>
<ul>
<li>option -&gt; register shell extensions</li>
<li>扩展文件接口 userdb.txt，可以自定义一些特征码，识别出新的文件类型</li>
<li>签名制作插件：add signature，配合od修正</li>
</ul>
<h4 id="312-fileinfo">3.1.2 fileinfo工具</h4>
<h3 id="32">3.2 静态反汇编</h3>
<h4 id="321">3.2.1 反汇编引擎</h4>
<ul>
<li>udis86</li>
<li>ade</li>
<li>xde</li>
<li>mlde32</li>
<li>virxasm</li>
<li>od插件：FullDisasm</li>
</ul>
<h4 id="322-ipa-pro">3.2.2 ipa pro简介</h4>
<ul>
<li>
<p>分析过程分2个阶段</p>
</li>
<li>
<p>将程序和代码分开</p>
<p>为函数做标记并分析其参数调用</p>
<p>分析跳转、调用等指令关系并给标签赋值等</p>
</li>
<li>
<p>识别出文件的编译类型，装载对应的编译器特征文件，给各函数赋名</p>
</li>
<li>
<p>加载出现错误</p>
</li>
<li>
<p>ida分析出有问题的代码</p>
<p>关闭 <code>Kernel Options1-&gt;make final analysis pass</code></p>
</li>
<li>
<p>一些代码不在预计的位置而不被确认</p>
<p>关闭<code>Kernel Options2-&gt;coagulate data segments in the final pass</code></p>
</li>
</ul>
<h4 id="323-ida">3.2.3 ida配置</h4>
<ul>
<li>
<p>idag.cfg文件</p>
</li>
<li>
<p>编辑工具：editplus、Ultraplus</p>
</li>
<li>
<p>组成：</p>
</li>
<li>
<p>定义文件的扩展名、内存、屏幕等</p>
</li>
<li>
<p>配置普通参数：代码显示格式、ascii字符显示格式、脚本定义、处理器选项</p>
</li>
<li>
<p>一些问题</p>
</li>
</ul>
<p>max_item_lines :默认5000，许多大文件不够用</p>
<ul>
<li>
<p>选项</p>
</li>
<li>
<p>反汇编选项</p>
</li>
<li>ascii字符串与符号</li>
<li>显示中文字符</li>
</ul>
<h4 id="324-ida">3.2.4 IDA主窗口界面</h4>
<h4 id="325">3.2.5 交叉参考</h4>
<ul>
<li>X键： 打开交叉参考窗口</li>
</ul>
<h4 id="326">3.2.6 参考重命名</h4>
<ul>
<li>N键</li>
</ul>
<h4 id="327">3.2.7 标签的用法</h4>
<ul>
<li>ctrl+M:跳到标记位置</li>
</ul>
<h4 id="328">3.2.8 进制的转换</h4>
<h4 id="329">3.2.9 代码和数据转换</h4>
<ul>
<li>C键：切换为指令</li>
<li>P键：定义为子程序</li>
<li>U键：重新以16进制数显示</li>
<li>D键：db、dw、dd之间转换</li>
</ul>
<h4 id="3210">3.2.10 字符串</h4>
<ul>
<li>A键：弹出ida支持的字符串格式</li>
<li>G键：跳转到某一地址</li>
<li>空格键：切换流程图和反汇编模式</li>
<li><strong>N键：重命名地址为某字符串</strong></li>
</ul>
<h4 id="3211">3.2.11 数组</h4>
<ul>
<li>edit/array 小键盘<code>*</code>:weary:</li>
</ul>
<h4 id="3212">3.2.12 结构体</h4>
<ul>
<li>
<p>shift+F11：加载类型库窗口 -&gt; intert键：可用的类型库窗口</p>
</li>
<li>
<p>shift+F9: 结构体管理窗口-&gt; insert键：增加结构体-&gt; add standart structure</p>
</li>
<li>
<p>ida 版本=5.x，shift+F9: 结构体管理窗口-&gt; insert键-&gt; cancel，结构体数据会显现出来</p>
</li>
<li>
<p>按<code>+</code>键，展开结构体，但是貌似只有在小键盘上有效？笔记本悲催:sweat:</p>
</li>
<li>
<p><a href="https://blog.csdn.net/hgy413/article/details/7104304">结构体定义详细解释</a></p>
</li>
<li>
<p>alt+Q: 在反汇编窗口中对数据应用结构体</p>
</li>
<li>
<p>T键：在操作数类型中应用结构体</p>
</li>
<li>
<p>批量替换结构体：选中需要替换的部分，T键，然后替换</p>
</li>
<li>
<p>从已经分析好的数据中建立结构体，选择好分析好的数据后：</p>
</li>
</ul>
<p>edit/structs/create from data</p>
<ul>
<li>在结构体中嵌套结构体union（共用体）</li>
</ul>
<p>在结构体窗口中使用alt+Q</p>
<ul>
<li>从c文件头中导入结构 <code>load file/parse c header file</code></li>
</ul>
<h4 id="3213">3.2.13 枚举类型</h4>
<ul>
<li>shift+F10：打开枚举类型窗口</li>
<li>insert添加</li>
<li>在代码窗口，M键替换</li>
<li>支持bit-fileds类型</li>
</ul>
<h4 id="3214">3.2.14 堆栈变量</h4>
<ul>
<li>ctrl+k:打开堆栈窗口</li>
</ul>
<h4 id="3215-idc">3.2.15 IDC脚本</h4>
<h5 id="1">实例1 查看输入函数</h5>
<pre><code class="c">//Imports.idc 列出当前程序的输入函数
//(c)  www.PEDIY.com 2000-2008

#include &lt;idc.idc&gt;

static GetImportSeg()
{
    auto ea, next, name;
    ea = FirstSeg();
    next = ea;
    while ( (next = NextSeg(next)) != -1) {
        name = SegName(next);
        if ( substr( name, 0, 6 ) == &quot;.idata&quot; ) break;
   }
   return next;
}

static main()
{
    auto BytePtr, EndImports;
    BytePtr = SegStart( GetImportSeg() );
    EndImports = SegEnd( BytePtr );
    Message(&quot; \n&quot; + &quot;Parsing Import Table...\n&quot;);
    while ( BytePtr &lt; EndImports ) {
        if (LineA(BytePtr, 1) != &quot;&quot;) Message(&quot;\n&quot; + &quot;____&quot; + LineA(BytePtr,1) + &quot;____&quot; + &quot;\n&quot;);
        Message(Name(BytePtr) + &quot;\n&quot;);
        BytePtr = NextAddr(BytePtr);
    }
    Message(&quot;\n&quot; + &quot;Import Table Parsing Complete\n&quot;);
}
</code></pre>

<ul>
<li>导入idc脚本</li>
</ul>
<p><code>File/idc file</code></p>
<h5 id="2-idc">实例2 用idc分析加密代码</h5>
<ul>
<li>SMC(self modifying code)</li>
</ul>
<p>```c
  //encrypted.idc
  //(c)  www.PEDIY.com 2000-2008</p>
<p>#include <idc.idc>
  static decrypt(from, size, key ) { 
     auto i, x; 
     for ( i=0; i &lt; size; i=i+1 ) { 
        x = Byte(from); 
        x = (x^key); 
        PatchByte(from,x); 
        from = from + 1;
     } </p>
<p>} 
  ```</p>
<ol>
<li>
<p><code>file/idc file</code>引入idc文件</p>
</li>
<li>
<p><code>shift+F2</code>执行idc函数</p>
<p><code>c
 decrypt(0x00401060,0x15,0x1)</code></p>
</li>
<li>
<p><code>U</code>将所有代码以数据形式显示出来</p>
</li>
<li>
<p><code>C</code>将此段代码重新分析</p>
</li>
<li>
<p>结合od</p>
</li>
</ol>
<p>通过ida的<code>additional binary file</code>的功能将od解码出的文件重新加载</p>
<ul>
<li>脚本工具：IDApython、IDAperl</li>
</ul>
<h4 id="3216-flirt">3.2.16 FLIRT</h4>
<ul>
<li>
<p>fast library identificaiton and recongnition technology</p>
</li>
<li>
<p>签名文件格式：.sig</p>
</li>
<li>
<p><code>shift+F5</code>：打开签名窗口</p>
</li>
</ul>
<p><code>insert</code>打开文件列表窗口，选中签名文件，然后激活</p>
<p>应用后，将自动重新分析全部代码</p>
<p>如果没有自动分析，<code>options/analysis</code>-&gt; <code>reanalyse program</code></p>
<ul>
<li>
<p>签名文件的制作：</p>
</li>
<li>
<p>有lib文件的情况</p>
<ol>
<li>pcf转换</li>
</ol>
<p><code>pcf *.lib *.pat</code></p>
<ol>
<li>sigmake转换</li>
</ol>
<p><code>sigmake *.pat *.sig</code></p>
</li>
<li>
<p>没有lib，只有dll</p>
<ol>
<li>反汇编该dll</li>
<li>idb2pat插件生成pat</li>
<li>sigmake签名</li>
</ol>
</li>
</ul>
<h4 id="3217">3.2.17 插件</h4>
<ul>
<li>hex-rays decomplier 反汇编成高级语言</li>
</ul>
<h4 id="3218">3.2.18 其他功能</h4>
<ol>
<li>
<p>图形化模式</p>
</li>
<li>
<p>加载符号文件</p>
</li>
</ol>
<p><code>load file/pdb file</code> 自动从微软官网寻找最合适当前版本的pdb或dbg</p>
<ol>
<li>
<p>api帮助关联</p>
</li>
<li>
<p>将idagui.cfg中的<code>helpfile</code>指向本地windows api帮助文件</p>
</li>
<li>
<p><code>ctrl + F1</code>实现查询</p>
</li>
<li>
<p>文件输出</p>
</li>
</ol>
<p><code>file/produce file</code></p>
<ol>
<li>
<p>map文件</p>
<p>各函数等符号信息</p>
</li>
<li>
<p>asm文件</p>
<p>仅输出汇编文件部分</p>
</li>
<li>
<p>dump database to IDC file</p>
<p>低版本向高版本恢复当前使用数据</p>
</li>
<li>
<p>dump typeinfo to IDC file</p>
<p>将用户自定义的数据类型保存到IDC文件</p>
</li>
</ol>
<h3 id="33">3.3 可执行文件的修改</h3>
<h4 id="hiew">hiew</h4>
<ul>
<li>快捷键</li>
</ul>
<table>
<thead>
<tr>
<th>按键</th>
<th>功能</th>
</tr>
</thead>
<tbody>
<tr>
<td>F5</td>
<td>跳转到地址（支持相对地址和虚拟地址（前面加上<code>.</code>））</td>
</tr>
<tr>
<td>F1</td>
<td>帮助</td>
</tr>
<tr>
<td>F3</td>
<td>进入编辑状态</td>
</tr>
<tr>
<td>F2</td>
<td>修改汇编代码</td>
</tr>
<tr>
<td>F9</td>
<td>保存</td>
</tr>
</tbody>
</table>
<h3 id="34">3.4 静态分析技术应用实例</h3>
<h4 id="341">3.4.1 解密初步</h4>
<h4 id="342">3.4.2 逆向工程初步</h4>
<h5 id="1-mission-failed">1. 移除"mission failed"对话框</h5>
<ol>
<li>IDA查看string窗口</li>
<li>双击字符“...mission failed...”,到代码处</li>
<li>双击交叉引用，记下地址</li>
<li>在OD中跳转到此地址，可nop掉，也可jump掉过，此处跳过，在<code>push 0</code>处，修改为<code>jmp 0040124E</code></li>
</ol>
<h5 id="2">2. 将输入字符显示到对话框</h5>
<ol>
<li>在IDA name窗口中，双击GetWindowTextA的调用处</li>
<li>发现有两次调用，第一处比较可疑，进入</li>
<li>OD将<code>jmp eax</code>nop掉，就可以执行下面的程序，GetWindowTextA将文本空间内容放到缓冲区，MessageBoxA从缓存区中读取文本并显示到消息框中</li>
</ol>
<h5 id="3">3. 修改字符</h5>
<p>​   修改指定的字符串</p>
<ol>
<li>
<p>查找指定字符串的两种方式</p>
<ol>
<li>
<p>IDA-&gt; shift+F12</p>
</li>
<li>
<p>OD -&gt; 鼠标右键-Search for-<em>All referenced text strings</em> </p>
</li>
</ol>
<p><strong>OD -&gt;鼠标右键-中文搜索-智能搜索</strong> -&gt; CTRL+F</p>
<p>ida给出的结果会更符合要求，OD给出了太多的结果</p>
<pre><code>    **new: 智能搜索更好用**
</code></pre>
<ol>
<li>
<p>在ida中找到字符串之后，在od跳转到该地址</p>
</li>
<li>
<p>在该处右键-&gt; follow dump-&gt; selection，会在内存窗口中看到该字符串</p>
</li>
<li>
<p><code>ctrl+e</code>修改，可以在notepad中写好，然后使用<code>shift+insert</code>粘贴</p>
</li>
<li>
<p>选中修改部分，右键-&gt;copy to executalbe file</p>
</li>
<li>
<p>在弹出的窗口中，选择修改后的部分，右键-&gt;save file</p>
</li>
</ol>
</li>
</ol>
<h5 id="4">4. 完成序列号验证</h5>
<ol>
<li>
<p>找到合适的地址</p>
</li>
<li>
<p>在od中修改，代码如下</p>
</li>
</ol>
<p><strong>？不知道有没有一次性复制粘贴的办法</strong></p>
<p><code>x86asm
   cmp ecx,5
   jnz 4012CD
   mov edx,403000
   mov bl,[eax]
   mov bh,[edx]
   cmp bl,bh
   jnz 4012CD
   inc eax
   inc edx
   dec ecx
   jz 4012B8
   jmp 40127A</code></p>
<ol>
<li>保存</li>
</ol>
<h3 id="35">3.5 补充</h3>
<h4 id="351">3.5.1 快捷键</h4>
<table>
<thead>
<tr>
<th>功能键</th>
<th>功能</th>
</tr>
</thead>
<tbody>
<tr>
<td>R</td>
<td>将16机制码以字符串形式解读</td>
</tr>
<tr>
<td>F5</td>
<td>显示反汇编的源码</td>
</tr>
<tr>
<td>shift+F12</td>
<td>显示strings窗口</td>
</tr>
<tr>
<td>alt+T</td>
<td>文本搜索</td>
</tr>
<tr>
<td>ctrl+T</td>
<td>继续下一个查找</td>
</tr>
<tr>
<td>alt+B</td>
<td>二进制搜索</td>
</tr>
<tr>
<td>B</td>
<td>2/16进制转换</td>
</tr>
<tr>
<td>A</td>
<td>解释光标处的地址为一个字符串的首地址</td>
</tr>
<tr>
<td>H</td>
<td>16/10进制转换</td>
</tr>
<tr>
<td>；</td>
<td>注释</td>
</tr>
<tr>
<td>X</td>
<td>转换视图为交叉参考模式</td>
</tr>
<tr>
<td>shift+E</td>
<td>提取数据</td>
</tr>
<tr>
<td>shift+F1</td>
<td>导出数据</td>
</tr>
</tbody>
</table>
<ul>
<li>F5：查看源代码的过程中，及时将变量名(<code>N键</code>)改为有意义的名称</li>
<li>函数窗口：红色的无法反汇编成源码，白色的可以</li>
</ul>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../%E5%8A%A0%E5%AF%86%E4%B8%8E%E8%A7%A3%E5%AF%86%20%E7%AC%AC%E4%BA%8C%E7%AB%A0-%E5%8A%A8%E6%80%81%E8%B0%83%E8%AF%95%E6%8A%80%E6%9C%AF/" class="btn btn-neutral float-right" title="加密与解密 第二章 动态调试技术">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../%E5%8A%A0%E5%AF%86%E4%B8%8E%E8%A7%A3%E5%AF%86%20%E7%AC%AC%E4%B8%80%E7%AB%A0-%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/" class="btn btn-neutral" title="加密与解密 第一章 基础知识"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
      <p>0Xor</p>
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../%E5%8A%A0%E5%AF%86%E4%B8%8E%E8%A7%A3%E5%AF%86%20%E7%AC%AC%E4%B8%80%E7%AB%A0-%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../%E5%8A%A0%E5%AF%86%E4%B8%8E%E8%A7%A3%E5%AF%86%20%E7%AC%AC%E4%BA%8C%E7%AB%A0-%E5%8A%A8%E6%80%81%E8%B0%83%E8%AF%95%E6%8A%80%E6%9C%AF/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../../..';</script>
    <script src="../../../js/theme.js"></script>
      <script src="../../../search/require.js"></script>
      <script src="../../../search/search.js"></script>

</body>
</html>
