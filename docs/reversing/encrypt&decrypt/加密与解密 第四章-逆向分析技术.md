åŠ å¯†ä¸è§£å¯† ç¬¬2ç¯‡ è°ƒè¯•ç¯‡

## ç¬¬4ç«  é€†å‘åˆ†ææŠ€æœ¯

### 4.1 å¯åŠ¨å‡½æ•°

- c/c++è¿è¡Œæ—¶å¯åŠ¨å‡½æ•°ä½œç”¨
  - æ£€ç´¢æŒ‡å‘æ–°è¿›ç¨‹çš„å‘½ä»¤è¡ŒæŒ‡é’ˆ
  - æ£€ç´¢æŒ‡å‘æ–°è¿›ç¨‹çš„ç¯å¢ƒå˜é‡æŒ‡é’ˆ
  - å…¨å±€å˜é‡åˆå§‹åŒ–
  - å†…å­˜å †æ ˆåˆå§‹åŒ–

```asm
00401020 >/$  55            push    ebp
00401021  |.  8BEC          mov     ebp, esp
00401023  |.  6A FF         push    -1
00401025  |.  68 A0504000   push    004050A0
0040102A  |.  68 7C1C4000   push    00401C7C                         ;  SE å¤„ç†ç¨‹åºå®‰è£…
0040102F  |.  64:A1 0000000>mov     eax, dword ptr fs:[0]
00401035  |.  50            push    eax
00401036  |.  64:8925 00000>mov     dword ptr fs:[0], esp
0040103D  |.  83EC 10       sub     esp, 10
00401040  |.  53            push    ebx
00401041  |.  56            push    esi
```

### 4.2 å‡½æ•°

### 4.2.1 å‡½æ•°çš„è¯†åˆ«

- CALL
- RET

### 4.2.2 å‡½æ•°çš„å‚æ•°

#### åˆ©ç”¨å †æ ˆä¼ é€’

```asm
00401000 >/$  6A 04         push    4                                ; /Arg2 = 00000004
00401002  |.  6A 03         push    3                                ; |Arg1 = 00000003
00401004  |.  E8 16000000   call    0040101F                         ; \Add.0040101F
00401009  |.  8BD8          mov     ebx, eax
0040100B  |.  6A 00         push    0                                ; /ExitCode = 0
0040100D  \.  FF15 00204000 call    [<&KERNEL32.ExitProcess>]        ; \ExitProcess


0040101F  /$  55            push    ebp                              ;  ä¿æŠ¤ç°åœºåŸå…ˆçš„EBPæŒ‡é’ˆ
00401020  |.  8BEC          mov     ebp, esp                         ;  è®¾ç½®æ–°çš„EBPæŒ‡é’ˆï¼ŒæŒ‡å‘æ ˆé¡¶
00401022  |.  83EC 04       sub     esp, 4                           ;  åˆ†é…å±€éƒ¨å˜é‡æ‰€æœ‰ç©ºé—´
00401025  |.  8B45 0C       mov     eax, [ebp+C]                     ;  è°ƒç”¨å‚æ•°2
00401028  |.  8B5D 08       mov     ebx, [ebp+8]                     ;  è°ƒç”¨å‚æ•°1
0040102B  |.  895D FC       mov     [ebp-4] , ebx                    ;  å‚æ•°1æ”¾å±€éƒ¨å˜é‡é‡Œ
0040102E  |.  0345 FC       add     eax,[ebp-4]                      ;  å‚æ•°2ä¸å±€éƒ¨å˜é‡ç›¸åŠ 
00401031  |.  83C4 04       add     esp, 4                           ;  é‡Šæ”¾å±€éƒ¨å˜é‡æ‰€æœ‰ç©ºé—´
00401034  |.  5D            pop     ebp                              ;  æ¢å¤ç°åœºçš„ebpæŒ‡é’ˆ
00401035  \.  C2 0800       retn    8
```

- enter/leave

   `enter = push ebp/move ebp,esp/sub esp,xxx`
   `leave = add esp,xxx/pop esp`

  ```asm
  enter xxx,0	;0è¡¨ç¤ºåˆ›å»ºxxxæ”¾å±€éƒ¨å˜é‡
  ...
  leave 
  ret 8
  ```

- vc6.0 ä½¿ç”¨`maximize speed`

  ```asm
  push par2 ;å‚æ•°2
  push par1 ;å‚æ•°1
  call test2
  {
   	move eax, dword ptr [esp+04] ;è°ƒç”¨å‚æ•°1
      move ecx, dword ptr [esp+08] ;è°ƒç”¨å‚æ•°2
      ...
      ret 8
  }
  ```

##### åˆ©ç”¨å¯„å­˜å™¨ä¼ é€’å˜é‡

- è§„èŒƒï¼š__fastcall

  ```c
  /*******************************************************
  *  fastcallè°ƒç”¨                                                                                                   *
  *   (c)  çœ‹é›ªè½¯ä»¶å®‰å…¨ç½‘ç«™ www.pediy.com 2000-2008                         *
  ********************************************************/
  
  int  __fastcall Add(char,long,int,int);
  
  main(void)
   {
  	    Add(1,2,3,4);
  	    return 0;
   }
  
  int __fastcall Add(char a, long b, int c, int d)
  
  {
  	   return (a + b + c + d);
  }
  
  ```

  vcç¼–è¯‘ï¼š `optimizations:default`

##### åç§°ä¿®é¥°çº¦å®š

- name mangling/name decoration
- åŒä¸€åå­—å…·æœ‰ä¸åŒçš„å‚æ•°æˆ–è€…ä¸åŒçš„ä½œç”¨åŸŸ
- cç¼–è¯‘æ—¶å‡½æ•°åä¿®é¥°çº¦å®šè§„åˆ™ï¼š
  - \__stdcallè°ƒç”¨çº¦å®šï¼š\_{functionname}@{byte_number}
  - \_cdelè°ƒç”¨çº¦å®šï¼š_{functionname}
  - __fastcallè°ƒç”¨çº¦å®šï¼š@{functionname}@{byte_number}

#### 4.2.3 å‡½æ•°çš„è¿”å›å€¼

##### 0x1 ç”¨returnè¿”å›

##### 0x2 é€šè¿‡å‚æ•°æŒ‰å¼•ç”¨æ–¹å¼è¿”å›

### 4.3 æ•°æ®ç»“æ„

#### 4.3.1 å±€éƒ¨å˜é‡

1. åˆ©ç”¨å †æ ˆ

   - `sub esp,8`

   - è°ƒç”¨æ ¼å¼ï¼š

     - å±€éƒ¨ï¼š[ebp-xxxx]
     - å‚æ•°è°ƒç”¨ï¼š[ebp+xxxx]

   - å±€éƒ¨å˜é‡ä¸æ¸…é™¤å †æ ˆçš„å‡ ç§å½¢å¼

     | å½¢å¼ä¸€                         | å½¢å¼äºŒ                     | å½¢å¼ä¸‰                |
     | ------------------------------ | -------------------------- | --------------------- |
     | sub esp,n<br /><br />add esp,n | add esp,-n<br />sub esp,-n | push reg<br />pop reg |

   - å±€éƒ¨å˜é‡åˆå§‹åŒ–

     - mov [ebp-04],5
     - push 5

2. åˆ©ç”¨å¯„å­˜å™¨

   é™¤äº†å †æ ˆå ç”¨2ä¸ªå¯„å­˜å™¨å¤–ï¼Œç¼–è¯‘å™¨ä¼šåˆ©ç”¨å‰©ä¸‹çš„6ä¸ªé€šç”¨å¯„å­˜å™¨

#### 4.3.2 å…¨å±€å˜é‡

- ä½äº.dataæ®µä¸­

- æ ¼å¼ï¼š

  ```asm
  move eax,dword ptr [4084c0h]
  ```

- ä½œç”¨ï¼š

  1. ä¼ é€’å‚æ•°
  2. ä¼ é€’å‡½æ•°è¿”å›å€¼

- ç¤ºä¾‹

  ```c
  /*******************************************************
  ã€ŠåŠ å¯†ä¸è§£å¯†ã€‹ç¬¬ä¸‰ç‰ˆé…å¥—å®ä¾‹
                                        4.3.2  å…¨å±€å˜é‡
  (c)  çœ‹é›ªè½¯ä»¶å®‰å…¨ç½‘ç«™ www.pediy.com 2000-2008
  ********************************************************/
  int z;
  
  int add(int x,int y);
  int main(void)
   {
  	 int a=5,b=6;
  	 z=7;
  	 add(a,b);
  	 return 0;
   }
  
   int add(int x,int y)
   {
  	 return(x+y+z);
   }
  ```

  vc++6.0ç¼–è¯‘ï¼Œé€‰æ‹©ä¸ä¼˜åŒ–

- ä¸é™æ€å˜é‡ç±»ä¼¼ï¼Œä½†é™æ€å˜é‡åªåœ¨å®šä¹‰è¿™äº›å˜é‡çš„å‡½æ•°å†…æœ‰æ•ˆ

#### 4.3.3  æ•°ç»„

- å®ç°æ–¹å¼ï¼šåŸºå€+å˜é‡

- ç¤ºä¾‹ï¼š

  ```c
  /*******************************************************
  ã€ŠåŠ å¯†ä¸è§£å¯†ã€‹ç¬¬ä¸‰ç‰ˆé…å¥—å®ä¾‹
                                        4.3.3 æ•°ç»„
  (c)  çœ‹é›ªè½¯ä»¶å®‰å…¨ç½‘ç«™ www.pediy.com 2000-2008
  ********************************************************/
  
  #include <stdio.h>
  
  int main(void)
  {
  	static int a[3]={0x11,0x22,0x33};
      int i,s=0,b[3];
  	for(i=0;i<3;i++)
  	{ 
  		s=s+a[i];
  		b[i]=s;
  	}
  	
  	for(i=0;i<3;i++)
  	{
  		printf("%d\n",b[i]);
  	}
  	
  	return 0;
  }
  
  ```

  ç¼–è¯‘ä¼˜åŒ–é€‰é¡¹ï¼šæœ€å¿«é€Ÿåº¦ï¼Œä½†æ˜¯æˆ‘buildå‡ºç°äº†é”™è¯¯ï¼š

  > Command line error D2016 : '/O2' and '/GZ' command-line options are incompatible
  > æ‰§è¡Œ cl.exe æ—¶å‡ºé”™.

  - /GZÂ å¯ä»¥å¸®åŠ©æ•è·å†…å­˜é”™è¯¯ 
  - /O1 æˆ– /O2 ä¼˜åŒ–å¼€å…³ï¼Œä½¿ç¨‹åºæœ€å°æˆ–æœ€å¿« 

  æ—¢ç„¶ä¸¤ä¸ªé€‰é¡¹ä¸å…¼å®¹ï¼Œé‚£ä¹ˆå°±æŠŠ/GZå»æ‰ï¼Œç¼–è¯‘æˆåŠŸ :happy:

- sample

  ```asm
  mov eax,[407030h+eax]
  ```

- æ•°ç»„å­˜åœ¨ä½ç½®

  1. å †æ ˆ
  2. æ•°æ®æ®µ .data
  3. åŠ¨æ€å†…å­˜

- é—´æ¥å¯»å€ä¸€èˆ¬å‡ºç°åœ¨ï¼š

  1. æ•°ç»„
  2. ç»“æ„èµ‹å€¼

- [åŸºå€+å¯„å­˜å™¨]

  - åŸºå€å¯ä»¥ä¸ºå¸¸é‡æˆ–è€…æ˜¯å¯„å­˜å™¨

### 4.4  è™šå‡½æ•° 

- è™šå‡½æ•°çš„åœ°å€ï¼šåœ¨è°ƒç”¨ä¹‹å‰åŠ ä»¥ç¡®å®š

- è™šå‡½æ•°è¡¨ï¼ˆVirtual Tableï¼ŒVTBLï¼‰ï¼šå­˜æ”¾è™šå‡½æ•°çš„å¼•ç”¨

- è™šå‡½æ•°è¡¨æŒ‡é’ˆï¼ˆVirtual Table Pointer,VPTRï¼‰:æŒ‡å‘å¯¹è±¡ä¸­çš„å‡½æ•°

- ç¤ºä¾‹ï¼š

  ```c
  /*******************************************************
  ã€ŠåŠ å¯†ä¸è§£å¯†ã€‹ç¬¬ä¸‰ç‰ˆé…å¥—å®ä¾‹
                                      4.4 è™šå‡½æ•°
  (c)  çœ‹é›ªè½¯ä»¶å®‰å…¨ç½‘ç«™ www.pediy.com 2000-2008
  ********************************************************/
  
  #include <stdio.h>
  class CSum
  {
  public:
  	virtual int Add(int a, int b) 
  	{
  		return (a + b);
  	}
  
  	virtual	int	Sub(int a, int b )
  	{
  		return (a - b);
  	}
  
  };
  
  void main()
  {   
  	CSum*	pCSum = new CSum ;  
  
  	pCSum->Add(1,2);
  	pCSum->Sub(1,2);
  
  
  } 
  
  ```

  æ±‡ç¼–ä»£ç ï¼š

  ```asm
  00401030 > > \56            push esi
  00401031   .  6A 04         push 0x4
  00401033   .  E8 88000000   call Calling_.operator new
  00401038   .  83C4 04       add esp,0x4
  0040103B   .  85C0          test eax,eax
  0040103D   .  74 0A         je XCalling_.00401049
  0040103F   .  C700 1C204100 mov dword ptr ds:[eax],offset Calling_.C>
  00401045   .  8BF0          mov esi,eax
  00401047   .  EB 02         jmp XCalling_.0040104B
  00401049   >  33F6          xor esi,esi
  0040104B   >  8B06          mov eax,dword ptr ds:[esi]
  0040104D   .  6A 02         push 0x2
  0040104F   .  6A 01         push 0x1
  00401051   .  8BCE          mov ecx,esi
  00401053   .  FF10          call dword ptr ds:[eax]
  00401055   .  8B16          mov edx,dword ptr ds:[esi]
  00401057   .  6A 02         push 0x2
  00401059   .  6A 01         push 0x1
  0040105B   .  8BCE          mov ecx,esi
  0040105D   .  FF52 04       call dword ptr ds:[edx+0x4]
  00401060   .  5E            pop esi
  00401061   .  C3            retn
  ```

  `mov ecx,esi`ä¸­ï¼Œecxä¿å­˜äº† ==thisæŒ‡é’ˆ==ï¼Œä½†æ˜¯ä»æ±‡ç¼–ä»£ç ä¸Šçœ‹ï¼Œæ²¡çœ‹å‡ºthisæŒ‡é’ˆçš„ä½œç”¨

  vtblä¸­çš„æ•°æ®ï¼š

  ```
  0041201C >05 10 40 00 0F 10 40 00  @.@.
  ```

  addå‡½æ•°ï¼š

  ```asm
  00401080 > > \8B4424 08     mov eax,dword ptr ss:[esp+0x8]
  00401084   .  8B4C24 04     mov ecx,dword ptr ss:[esp+0x4]
  00401088   .  03C1          add eax,ecx
  0040108A   .  C2 0800       retn 0x8
  ```

  subå‡½æ•°ï¼š

  ```asm
  004010A0 > > \8B4424 04     mov eax,dword ptr ss:[esp+0x4]
  004010A4   .  8B4C24 08     mov ecx,dword ptr ss:[esp+0x8]
  004010A8   .  2BC1          sub eax,ecx
  004010AA   .  C2 0800       retn 0x8
  ```


### 4.5  æ§åˆ¶è¯­å¥

#### 4.5.1  IF-THEN-ELSEè¯­å¥ 

- æ±‡ç¼–ä»£ç 

  - æ•´æ•°

    - cmp 

      `a-b`çš„ç»“æœï¼Œå½±å“ZF/è¿›ä½/ç¬¦å·ä½/æº¢å‡ºæ ‡å¿—

      ```asm
      cmp a,b
      jzï¼ˆjnzï¼‰ xxxx
      ```

    - test

      `a &&b` aå’Œbé€»è¾‘ä¸çš„ç»“æœï¼Œç»“æœä¸º0ï¼ŒZFç½®1

    - or

```asm
00401010   push        ecx
11:        int a,b=5;
12:   scanf("%d",&a);
00401011   lea         eax,[esp]
00401015   push        eax
00401016   push        offset string "%d" (00416a30)
0040101B   call        scanf (00401050)
13:        if(a==0)
00401020   mov         eax,dword ptr [esp+8]
00401024   add         esp,8
00401027   test        eax,eax
00401029   jne         main+20h (00401030)
14:            a=8;
0040102B   mov         eax,8
15:
16:
17:        return a+b;
00401030   add         eax,5
18:    }
00401033   pop         ecx
00401034   ret

```

#### 4.5.2  SWITCH-CASEè¯­å¥

- æ²¡æœ‰ä¼˜åŒ–çš„æƒ…å†µä¸‹ï¼Œç¼–è¯‘ï¼š

```asm
00401010   push        ebp
00401011   mov         ebp,esp
00401013   sub         esp,8
00401016   mov         dword ptr [ebp-8],0CCCCCCCCh
0040101D   mov         dword ptr [ebp-4],0CCCCCCCCh
11:        int a;
12:        scanf("%d",&a);
00401024   lea         eax,[a]
00401027   push        eax
00401028   push        offset ___xt_z+104h (00417a30)
0040102D   call        scanf (00401140)
00401032   add         esp,8
13:
14:        switch(a)
15:        {
00401035   mov         ecx,dword ptr [a]
00401038   mov         dword ptr [ebp-8],ecx
0040103B   cmp         dword ptr [ebp-8],1	;case 1
0040103F   je          main+3Fh (0040104f)	
00401041   cmp         dword ptr [ebp-8],2	;case 2
00401045   je          main+4Eh (0040105e)
00401047   cmp         dword ptr [ebp-8],0Ah	;case 10
0040104B   je          main+5Dh (0040106d)
0040104D   jmp         main+6Ch (0040107c)
16:           case 1 :printf("a=1");
0040104F   push        offset ___xt_z+108h (00417a34)
00401054   call        printf (004010c0)
00401059   add         esp,4
17:                       break;
0040105C   jmp         main+79h (00401089)
18:           case 2 :printf("a=2");
0040105E   push        offset ___xt_z+10Ch (00417a38)
00401063   call        printf (004010c0)
00401068   add         esp,4
19:                       break;
0040106B   jmp         main+79h (00401089)
20:           case 10:printf("a=10");
0040106D   push        offset ___xt_z+110h (00417a3c)
00401072   call        printf (004010c0)
00401077   add         esp,4
21:                       break;
0040107A   jmp         main+79h (00401089)
22:           default :printf("a=default");
0040107C   push        offset ___xt_z+118h (00417a44)
00401081   call        printf (004010c0)
00401086   add         esp,4
23:                        break;
24:        }
25:
26:        return 0;
00401089   xor         eax,eax
```

- è®¾ç½®äº†æœ€å¤§é€Ÿåº¦çš„æƒ…å†µä¸‹ï¼Œç¼–è¯‘ï¼š

```asm
9:    int main(void)
10:    {
0040F9A0   push        ecx	;ä¸ºå±€éƒ¨å˜é‡åˆ†é…å†…å­˜ï¼Œç›¸å½“äºsub esp,4
11:        int a;
12:        scanf("%d",&a);
0040F9A1   lea         eax,[esp]
0040F9A5   push        eax
0040F9A6   push        offset string "%d" (00417d1c)
0040F9AB   call        scanf (00401140)
13:
14:        switch(a)
15:        {
0040F9B0   mov         eax,dword ptr [esp+8]
0040F9B4   add         esp,8
0040F9B7   dec         eax	;æ£€æŸ¥eaxæ˜¯å¦ä¸º1ï¼Œå¦‚æœæ˜¯ï¼Œä¸‹ä¸€å¥å°±è·³è½¬
0040F9B8   je          main+55h (0040f9f5)	;ç›¸å½“äºcase 1
0040F9BA   dec         eax	;eaxå†å‡1ï¼Œå³åŸæ¥çš„eaxæ˜¯2
0040F9BB   je          main+44h (0040f9e4)	;ç›¸å½“äº case 2
0040F9BD   sub         eax,8				;åŸæ¥çš„å€¼ä¸º10
0040F9C0   je          main+33h (0040f9d3)	;case 10
21:                       break;
22:           default :printf("a=default");
0040F9C2   push        offset string "a=default" (0041a358)
0040F9C7   call        printf (004010c0)
0040F9CC   add         esp,4
23:                        break;
24:        }
25:
26:        return 0;
0040F9CF   xor         eax,eax
27:    }
0040F9D1   pop         ecx
0040F9D2   ret
19:                       break;
20:           case 10:printf("a=10");
0040F9D3   push        offset string "a=10" (00417e94)
0040F9D8   call        printf (004010c0)
0040F9DD   add         esp,4
23:                        break;
24:        }
25:
26:        return 0;
0040F9E0   xor         eax,eax
27:    }
0040F9E2   pop         ecx
0040F9E3   ret
17:                       break;
18:           case 2 :printf("a=2");
0040F9E4   push        offset string "a=2" (00417a64)
0040F9E9   call        printf (004010c0)
0040F9EE   add         esp,4
23:                        break;
24:        }
25:
26:        return 0;
0040F9F1   xor         eax,eax
27:    }
0040F9F3   pop         ecx
0040F9F4   ret
16:           case 1 :printf("a=1");
0040F9F5   push        offset string "a=1" (00417a50)
0040F9FA   call        printf (004010c0)
0040F9FF   add         esp,4
23:                        break;
24:        }
25:
26:        return 0;
0040FA02   xor         eax,eax
27:    }
0040FA04   pop         ecx
0040FA05   ret

```

- å½“caseå–å€¼è¡¨ç¤ºä¸€ä¸ªç®—æœ¯çº§æ•°ï¼Œç¼–è¯‘å™¨ä¼šåˆ©ç”¨ä¸€ä¸ªè·³è½¬è¡¨æ¥å®ç°

  æ³¨ï¼šä½¿ç”¨vc6.0è°ƒè¯•ï¼Œäº§ç”Ÿçš„è°ƒè¯•ä¿¡æ¯ï¼Œä½†æ˜¯æœ‰ä¸€å¤„æ³¨é‡Šæœ‰æ˜æ˜¾çš„é—®é¢˜ï¼Œ`case 1`ä¸‹é¢æ˜¯æ²¡æœ‰defualtè¯­å¥çš„ï¼Œä½†æ˜¯vcçš„æ³¨é‡Šå´æ˜¾ç¤ºäº†`default :printf("a=default");`ï¼Œè¿™é‡Œéœ€è¦æ³¨æ„

```asm
   int main(void)
11:    {
00401010 51                   push        ecx
12:        int a;
13:        scanf("%d",&a);
00401011 8D 44 24 00          lea         eax,[esp]
00401015 50                   push        eax
00401016 68 58 7A 41 00       push        offset string "%d" (00417a58)
0040101B E8 80 01 00 00       call        scanf (004011a0)
14:
15:        switch(a)
16:        {
00401020 8B 4C 24 08          mov         ecx,dword ptr [esp+8]
00401024 83 C4 08             add         esp,8
00401027 8D 41 FF             lea         eax,[ecx-1]
0040102A 83 F8 06             cmp         eax,6	;åˆ¤æ–­æ˜¯å¦ä¸ºdefaultèŠ‚ç‚¹
0040102D 77 7E                ja          $L545+11h (004010ad)
0040102F FF 24 85 C0 10 40 00 jmp         dword ptr [eax*4+4010C0h]	;è·³è½¬è¡¨
17:           case 1 :printf("a=1");
00401036 68 54 7A 41 00       push        offset string "a=1" (00417a54)
30:                       break;
31:
32:           default :printf("a=default");
0040103B E8 E0 00 00 00       call        printf (00401120)
00401040 83 C4 04             add         esp,4
33:                        break;
34:        }
35:
36:        return 0;
00401043 33 C0                xor         eax,eax
37:    }
00401045 59                   pop         ecx
00401046 C3                   ret
18:                       break;
19:           case 2 :printf("a=2");
00401047 68 50 7A 41 00       push        offset string "a=2" (00417a50)
30:                       break;
31:
32:           default :printf("a=default");
0040104C E8 CF 00 00 00       call        printf (00401120)
00401051 83 C4 04             add         esp,4
33:                        break;
34:        }
35:
36:        return 0;
00401054 33 C0                xor         eax,eax
37:    }
00401056 59                   pop         ecx
00401057 C3                   ret
20:                       break;
...//çœç•¥æ‰ç±»ä¼¼çš„å†…å®¹
31:
32:           default :printf("a=default");
004010AD 68 30 7A 41 00       push        offset string "a=default" (00417a30)
004010B2 E8 69 00 00 00       call        printf (00401120)
004010B7 83 C4 04             add         esp,4
33:                        break;
34:        }
35:
36:        return 0;
004010BA 33 C0                xor         eax,eax
37:    }
004010BC 59                   pop         ecx
004010BD C3                   ret
004010BE 8B FF                mov         edi,edi
004010C0 36 10 40 00          adc         byte ptr ss:[eax],al
004010C4 47                   inc         edi
004010C5 10 40 00             adc         byte ptr [eax],al
004010C8 58                   pop         eax
004010C9 10 40 00             adc         byte ptr [eax],al
004010CC 69 10 40 00 7A 10    imul        edx,dword ptr [eax],107A0040h
004010D2 40                   inc         eax
004010D3 00 8B 10 40 00 9C    add         byte ptr [ebx-63FFBFF0h],cl
004010D9 10 40 00             adc         byte ptr [eax],al
```



#### 4.5.3  è½¬ç§»æŒ‡ä»¤æœºå™¨ç çš„è®¡ç®— 

![1533135272251](../../_images/crypto/1533135272251.png)

#### 4.5.4  æ¡ä»¶è®¾ç½®æŒ‡ä»¤ï¼ˆSETccï¼‰ 91

#### 4.5.5  çº¯ç®—æ³•å®ç°é€»è¾‘åˆ¤æ–­ 92

#### 4.6  å¾ªç¯è¯­å¥ 93

#### 4.7  æ•°å­¦è¿ç®—ç¬¦ 94

##### 4.7.1  æ•´æ•°çš„åŠ æ³•å’Œå‡æ³• 94

##### 4.7.2  æ•´æ•°çš„ä¹˜æ³• 94

##### 4.7.3  æ•´æ•°çš„é™¤æ³• 95

#### 4.8  æ–‡æœ¬å­—ç¬¦ä¸² 97

##### 4.8.1  å­—ç¬¦ä¸²å­˜å‚¨æ ¼å¼ 97

##### 4.8.2  å­—ç¬¦å¯»å€æŒ‡ä»¤ 98

##### 4.8.3  å­—æ¯å¤§å°å†™è½¬æ¢ 98

##### 4.8.4  è®¡ç®—å­—ç¬¦ä¸²çš„é•¿åº¦ 99

# 4.9  æŒ‡ä»¤ä¿®æ”¹æŠ€å·§ 99